---
import { languages } from "@/config/i18n/messages";
import { getLangFromUrl, transformUrlToLang } from "@/config/i18n/utils";

const currentRoute = Astro.url;
const lang = getLangFromUrl(currentRoute);
---

<div class="dropdown dropdown-hover dropdown-end">
  <summary role="button" class="btn rounded-2xl adaptive-text bg-white dark:bg-base-100">
    <span class="icon-[mdi--language] w-4 h-4"></span>
  </summary>
  <ul class="menu dropdown-content rounded-box z-1 w-32 p-2 shadow-sm adaptive-text bg-white dark:bg-base-100">
      <li><a id="en" class={lang === "en" ? "pointer-events-none text-gray-500" : ""} href={transformUrlToLang(currentRoute, "en")}>{languages.en}</a></li>
      <li><a id="es" class={lang === "es" ? "pointer-events-none text-gray-500" : ""} href={transformUrlToLang(currentRoute, "es")}>{languages.es}</a></li>
  </ul>
</div>

<script>
document.getElementById("en")?.addEventListener("click", () => {
  localStorage.setItem("lang", "en");
})

document.getElementById("es")?.addEventListener("click", () => {
  localStorage.setItem("lang", "es");
})
</script>