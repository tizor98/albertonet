---
import { Image } from "astro:assets";
import { getLangFromUrl } from "@/config/i18n/utils";
import { paths } from "@/config/paths";
import type { PostEntry } from "@/content.config";
import defaultBlogImage from "@/presentation/assets/blog-placeholder-1.png";
import FormattedDate from "../ui/FormattedDate.astro";

interface Props {
    post: PostEntry;
    showDescription?: boolean;
}

const { post, showDescription = false } = Astro.props;
const lang = getLangFromUrl(Astro.url);
---

<a
    href={paths.blogPost(lang, post.data.slug)}
    class="ui-card ui-card-hover w-full h-full flex flex-col items-start justify-start"
>
    <div class="w-full">
        <Image
            loading="lazy"
            transition:name={`img-${post.data.title}`}
            id={`img-${post.data.title}`}
            width={575}
            height={275}
            fit="cover"
            class="block m-auto aspect-[575/275] object-cover"
            src={post.data.heroImage ?? defaultBlogImage}
            alt={post.data.title}
        />
    </div>
    <h4
        transition:name={`title-${post.data.title}`}
        id={`title-${post.data.title}`}
        class:list={[
            "title text-base font-semibold adaptive-text px-4 pt-4 line-clamp-2 min-h-[3rem]",
        ]}
    >
        {post.data.title}
    </h4>
    <p class="ui-meta px-4">
        <FormattedDate date={post.data.pubDate} />
    </p>
    {showDescription && (
        <p class="ui-muted prose prose-sm text-sm px-4 line-clamp-3 mt-1">
            {post.data.description}
        </p>
    )}
    <div class="mt-3 text-xs tracking-tight flex flex-wrap gap-2 px-4 pb-4">
        {post.data.categories.map((category) => {
            return (
                <p class="ui-chip text-center">
                    {category}
                </p>
            );
        })}
    </div>
    <div class="flex-grow-0 flex-shrink-0 flex-1" />
</a>
