---
import { getCollection } from "astro:content";
import {
    getBlogNameFromLang,
    getLangFromUrl,
    useTranslations,
} from "@/config/i18n/utils";
import { paths } from "@/config/paths";
import Link from "../ui/Link.astro";
import PostCard from "../cross/PostCard.astro";

const lang = getLangFromUrl(Astro.url);
const blogName = getBlogNameFromLang(lang);
const topPosts = (await getCollection(blogName))
    .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
    .slice(0, 5);

const t = useTranslations(lang, "home");
---

<section
    id="top-posts-list"
    class="container flex flex-col items-center gap-5 px-8"
>
    <h2 class="text-3xl font-semibold tracking-wide adaptive-text">
        {t("topPosts")}
    </h2>
    <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5 self-center md:self-start">
        {topPosts.map((post) => (<PostCard post={post} />))}
    </section>
    <Link href={paths.blog(lang)} class="self-start">
        <div class="flex items-center text-lg gap-1">
            <span class="icon-[mdi--arrow-right-box]"></span>
            <p>{t("seeMore")}</p>
        </div>
    </Link>
</section>