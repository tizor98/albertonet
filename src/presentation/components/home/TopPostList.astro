---
import { getCollection } from "astro:content";
import {
    getBlogNameFromLang,
    getLangFromUrl,
    useTranslations,
} from "@/config/i18n/utils";
import { paths } from "@/config/paths";
import PostCard from "../cross/PostCard.astro";
import Link from "../ui/Link.astro";

const lang = getLangFromUrl(Astro.url);
const blogName = getBlogNameFromLang(lang);
const topPosts = (await getCollection(blogName))
    .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
    .slice(0, 5);

const t = useTranslations(lang, "home");
---

<section
    id="top-posts-list"
    class="container flex flex-col items-start gap-6 px-5 md:px-8"
>
    <h2 class="text-2xl md:text-3xl font-semibold tracking-tight adaptive-text">
        {t("topPosts")}
    </h2>
    <section class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-5 w-full">
        {topPosts.map((post) => (
            <div class="w-full min-h-[420px] flex">
                <PostCard post={post} />
            </div>
        ))}
    </section>
    <Link href={paths.blog(lang)} class="self-start ui-meta">
        <div class="flex items-center text-sm md:text-base gap-1">
            <span class="icon-[mdi--arrow-right-box]"></span>
            <p>{t("seeMore")}</p>
        </div>
    </Link>
</section>
